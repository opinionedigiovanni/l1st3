<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accesso ai File Privati</title>
</head>
<body>
    <h1>Scarica i file dalla Repository Privata</h1>
    <button onclick="getFile()">Ottieni il File</button>
    <p id="link"></p>

    <script>
        async function getFile() {
            const url = "https://api.github.com/repos/opinionedigiovanni/tv/contents/channels_italy.m3u8";
            const token = "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";

            try {
                const response = await fetch(url, {
                    headers: { 
                        Authorization: `Bearer ${token}`,
                        Accept: "application/vnd.github.v3.raw"
                    }
                });

                if (!response.ok) throw new Error("Errore nel recupero del file");

                const fileBlob = await response.blob();
                const fileURL = URL.createObjectURL(fileBlob);
                
                document.getElementById("link").innerHTML = `<a href="${fileURL}" download>Scarica il file</a>`;
            } catch (error) {
                console.error(error);
                document.getElementById("link").textContent = "Errore nel recupero del file";
            }
        }
    </script>
</body>
</html>
